library(devtools)
library(help="devtools")
?use_data
hubble <- read.csv("~/public_html/data/hubble.dat", sep="")
View(hubble)
use_data(hubble)
?document
?use_package
use_package("INLA","suggests")
use_readme_rmd(pkg = ".")
---
:
View(hubble)
document()
install.packages("roxygen2")
library(roxygen2)
document()
document()
hubble
cars
library(faraway)
head(gala)
bigmod = lm(Species ~ Endemics + Area + Elevation, gala)
bigmod = lm(Species ~ Area + Elevation + Adjacent, gala)
smallmod = lm(Species ~ Elevation, gala)
anova(bigmod, smallmod)
anova(smallmod, bigmod)
load("~/publish/brinla/brinla/data/hubble.rda")
hubble
document()
library(devtolls)
library(devtools)
document()
usair
usair <- read.csv("~/Dropbox/My book/DataCode/Chp3/usair.csv")
View(usair)
use_data(usair)
head(usair)
document()
document()
document()
library(INLA)
?data
document()
?data
document()
?data
document()
?data
document()
?data
data()
Spine_KYPHOSIS <- read.csv("~/Dropbox/My book/DataCode/Chp8/Spine_KYPHOSIS.csv")
View(Spine_KYPHOSIS)
use_data()
kyphosis <- read.csv("~/Dropbox/My book/DataCode/Chp8/Spine_KYPHOSIS.csv")
View(Spine_KYPHOSIS)
use_data(kyphosis)
head(kyphosis)
document()
document()
document()
library(brinla)
library(brinla)
document()
library(brinla)
document()
library(brinla)
document()
library(brinla)
document()
library(brinla)
document()
library(brinla)
library(brinla)
library(HistData)
GaltonFamilies
library(faraway)
help(fpe)
data(fpe,package="faraway")
head(fpe)
lmod <- lm(A2 ~ A+B+C+D+E+F+G+H+J+K+N-1, fpe)
coef(lmod)
library(mgcv)
M <- list(X=model.matrix(lmod), y=fpe$A2, Ain=rbind(diag(11),-diag(11)), C=matrix(0,0,0), array(0,0), S=list(), off=NULL, p=rep(0.5,11), bin=c(rep(0,11), rep(-1,11)))
a <- pcls(M)
lmod <- lm(A2 ~ A+B+C+D+E+F+G+H+J+K+N-1, fpe)
coef(lmod)
a <- pcls(M)
M$w
M$y
length(M$y)
M <- list(w=rep(1,24),X=model.matrix(lmod), y=fpe$A2, Ain=rbind(diag(11),-diag(11)), C=matrix(0,0,0), array(0,0), S=list(), off=NULL, p=rep(0.5,11), bin=c(rep(0,11), rep(-1,11)))
a <- pcls(M)
names(a) <- colnames(model.matrix(lmod))
round(a,3)
cmod <- inla(A2 ~ -1 + f(A+B+C+D+E+F+G+H+J+K+N, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
library(INLA)
cmod <- inla(A2 ~ -1 + f(A+B+C+D+E+F+G+H+J+K+N, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod <- inla(A2 ~ -1 + f(A, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod$summary.hyperpar
cmod <- inla(A2 ~ -1 + f(A+B, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod <- inla(A2 ~ -1 + f(A, model = "clinear", range = c(0, 1)) + f(B, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod$summary.hyperpar
cmod <- inla(A2 ~ -1 + f(A, model = "clinear", range = c(0, 1)) + f(B, model = "clinear", range = c(0, 1))+ f(C, model = "clinear", range = c(0, 1)) + f(D, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod$summary.hyperpar
cmod <- inla(A2 ~ -1 + f(A, model = "clinear", range = c(0, 1)) + f(B, model = "clinear", range = c(0, 1))+ f(C, model = "clinear", range = c(0, 1)) + f(D, model = "clinear", range = c(0, 1))+ f(E, model = "clinear", range = c(0, 1)) + f(F, model = "clinear", range = c(0, 1))+ f(G, model = "clinear", range = c(0, 1)) + f(H, model = "clinear", range = c(0, 1))+ f(J, model = "clinear", range = c(0, 1))+ f(K, model = "clinear", range = c(0, 1)) + f(N, model = "clinear", range = c(0, 1)), family="gaussian",data=fpe)
cmod$summary.hyperpar
library(brinla)
setwd("~/publish/brinla/brinla")
reeds = read.csv("reeds.csv")
reeds = read.csv("../reeds.csv")
list.files()
reeds = read.csv("../reeds.csv")
dir()
dirname()
reeds = read.csv("../examples/reeds.csv")
reeds = read.csv("../examples/reeds.csv",header=TRUE
)
library(reshape2)
melt(reeds,value.name = "nitrogen", variable.name = "site")
reeds = read.csv("../examples/reeds.csv",header=FALSE)
melt(reeds,value.name = "nitrogen", variable.name = "site")
colnames(reeds) = LETTERS[1:3]
melt(reeds,value.name = "nitrogen", variable.name = "site")
reeds = melt(reeds,value.name = "nitrogen", variable.name = "site")
save(reeds, file="data/reeds.rda")
library(brinla)
fossil <- read.table("../examples/fossil.dat",header=TRUE)
fossil$sr <- (fossil$sr-0.7)*100
i = order(fossil$age)
fossil = fossil[i,]
save(fossil, file="data/fossil.rda")
dim(fossil)
head(fossil)
library(brinla)
data(")
")"
round(a,3)
)
")"
data()
document("reeds")
library(devtools)
document("reeds")
?document
document("brinla")
document(brinla)
document()
document()
library(brinla)
?reeds
ggplot(reeds,aes(site,nitrogen))+geom_point()
library(lme4)
mmod <- lmer(nitrogen ~ 1+(1|site), reeds)
summary(mmod)
formula <- nitrogen ~ 1 + f(site, model="iid")
result = inla(formula,family="gaussian", data = reeds)
library(INLA)
result = inla(formula,family="gaussian", data = reeds)
summary(result)
inla.contrib.sd(result)$hyper
prec.alpha <- result$marginals.hyperpar$"Precision for operator"
prec.epsilon <- result$marginals.hyperpar$"Precision for the Gaussian observations"
sigma.alpha <- inla.tmarginal(function(x) 1/sqrt(x), prec.operator)
sigma.epsilon <- inla.tmarginal(function(x) 1/sqrt(x), prec.epsilon)
x <- seq(0,1,len=100)
d1 <- inla.dmarginal(x,sigma.alpha)
d2 <- inla.dmarginal(x,sigma.epsilon)
rdf <- data.frame(bright=c(x,x),sigma=gl(2,100,labels=c("alpha","epsilon")),density=c(d1,d2))
ggplot(rdf, aes(x=bright, y=density, color=sigma))+geom_line()
sigma.alpha <- inla.tmarginal(function(x) 1/sqrt(x), prec.alpha)
prec.alpha <- result$marginals.hyperpar$"Precision for site"
prec.epsilon <- result$marginals.hyperpar$"Precision for the Gaussian observations"
sigma.alpha <- inla.tmarginal(function(x) 1/sqrt(x), prec.alpha)
sigma.epsilon <- inla.tmarginal(function(x) 1/sqrt(x), prec.epsilon)
x <- seq(0,1,len=100)
d1 <- inla.dmarginal(x,sigma.alpha)
d2 <- inla.dmarginal(x,sigma.epsilon)
rdf <- data.frame(bright=c(x,x),sigma=gl(2,100,labels=c("alpha","epsilon")),density=c(d1,d2))
ggplot(rdf, aes(x=bright, y=density, color=sigma))+geom_line()
reff <- result$marginals.random
x <- seq(-1.5,1.5,len=100)
d1 <- inla.dmarginal(x, reff$site[[1]])
d2 <- inla.dmarginal(x, reff$site[[2]])
d3 <- inla.dmarginal(x, reff$site[[3]])
rdf <- data.frame(bright=x,density=c(d1,d2,d3),operator=gl(3,100,labels=LETTERS[1:4]))
ggplot(rdf, aes(x=bright, y=density, color=operator))+geom_line()
rdf <- data.frame(bright=x,density=c(d1,d2,d3),site=gl(3,100,labels=LETTERS[1:4]))
ggplot(rdf, aes(x=bright, y=density, color=site))+geom_line()
install.packages("INLA", repos="https://www.math.ntnu.no/inla/R/testing")
fossil <- read.table("fossil.dat",header=TRUE)
setwd("~/publish/brinla/brinla")
setwd("~/publish/brinla/examples")
library(INLA)
library(ggplot2)
fossil <- read.table("fossil.dat",header=TRUE)
fossil$sr <- (fossil$sr-0.7)*100
(pf <- ggplot(fossil, aes(age, sr)) + geom_point() + xlab("Age")+ylab("Strontium Ratio"))
inla.data <- list(y = fossil$sr, x = inla.group(fossil$age))
formula <- y ~ -1 + f(x, model = 'rw2', constr = FALSE, scale.model = T)
result <- inla(formula, data = inla.data, control.compute = list(config = TRUE), control.predictor = list(compute = TRUE))
postmean <- data.frame(x=unique(inla.data$x),y=result$summary.random$x$mean)
pf + geom_line(data=postmean,aes(x,y))
str(inla.group(fossil$age))
str(unique(fossil$age))
str(y=result$summary.random$x$mean)
y=result$summary.random$x$mean
str(y)
x=unique(inla.data$x)
str(x)
postmean <- data.frame(x=sort(unique(inla.data$x)),y=result$summary.random$x$mean)
pf + geom_line(data=postmean,aes(x,y))
inla.data$x
reading = read.table("reading_pp.txt", header=TRUE, sep=",")
pwd()
list.files()
reading = read.table("../examples/reading_pp.txt", header=TRUE, sep=",")
reading$id = factor(reading$id)
head(reading)
reading$wave = NULL
reading$age = NULL
head(reading)
save(reading,file="data/reading.rda")
dim(reading)
library(roxygen2)
roxygenise("R/reading.R")
library(brinla)
library(brinla)
q()
library(devtools)
document()
library(brinla)
r = result
document()
document()
library(brinla)
library(brinla)
library(brinla)
install.packages("INLA", repos="https://www.math.ntnu.no/inla/R/testing")
install.packages("INLA", repos = "https://www.math.ntnu.no/inla/R/testing")
install.packages("INLA", repos = "https://www.math.ntnu.no/inla/R/testing")
install.packages("INLA", repos = "https://www.math.ntnu.no/inla/R/testing")
library(INLA)
q()
library(devtools)
document()
library(brinla)
?invisible
library(brinla)
library(devtools)
document()
library(brinla)
document()
library(brinla)
library(faraway)
?ohio
document()
document()
library(brinla)
document()
document()
library(brinla)
library(brinla)
?stack
library(brinla)
library(help="brinla")
library(ggplot2)
library(INLA)
library(brinla)
formula <- nitrogen ~ 1 + f(site, model="iid")
imod = inla(formula,family="gaussian", data = reeds)
summary(imod)
sqrt(1/imod$summary.hyperpar[,-2])
sdt=sqrt(1/imod$summary.hyperpar[,-2])
?gsub
sub("Precision","SD",sdt)
row.names(sdt)
row.names(sdt) = c("SD of epsilson","SD of site")
sdt
?require
library(brinla)
library(brinla)
library(devtools)
document()
warnings()
library(brinla)
library(help="brinla")
library(brinla)
library(help="brinla")
q()
